Getting deep into functions and nested loops
